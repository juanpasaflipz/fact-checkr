; Supervisor configuration for Celery workers
; Install supervisor: pip install supervisor
; Usage: supervisord -c supervisor_celery.conf
; Control: supervisorctl -c supervisor_celery.conf

[unix_http_server]
file=/tmp/supervisor_celery.sock

[supervisord]
logfile=/Users/juan/fact-checkr/backend/logs/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
loglevel=info
pidfile=/tmp/supervisord_celery.pid
nodaemon=false
minfds=1024
minprocs=200

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor_celery.sock

; Celery Worker
[program:celery_worker]
command=/Users/juan/fact-checkr/backend/venv/bin/celery -A app.worker worker --loglevel=info --concurrency=2
directory=/Users/juan/fact-checkr/backend
user=juan
autostart=true
autorestart=true
startsecs=10
startretries=3
stopwaitsecs=600
killasgroup=true
priority=999
stdout_logfile=/Users/juan/fact-checkr/backend/logs/celery_worker.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/Users/juan/fact-checkr/backend/logs/celery_worker_error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=PATH="/Users/juan/fact-checkr/backend/venv/bin:%(ENV_PATH)s"

; Celery Beat (Scheduler)
[program:celery_beat]
command=/Users/juan/fact-checkr/backend/venv/bin/celery -A app.worker beat --loglevel=info
directory=/Users/juan/fact-checkr/backend
user=juan
autostart=true
autorestart=true
startsecs=10
startretries=3
stopwaitsecs=600
killasgroup=true
priority=998
stdout_logfile=/Users/juan/fact-checkr/backend/logs/celery_beat.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/Users/juan/fact-checkr/backend/logs/celery_beat_error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=PATH="/Users/juan/fact-checkr/backend/venv/bin:%(ENV_PATH)s"

